/* --- Base & Theme Setup --- */
body { font-family: 'Inter', sans-serif; font-weight: 500; }
h1, h2, h3, h4, h5, h6 { font-weight: 800; }
.theme-light { background-color: #f8fafc; }
.theme-dark { background-color: #0f172a; color: #e2e8f0; }

/* --- Watermark Background --- */
#main-content,
.view-container {
    position: relative;
    z-index: 1;
}

/* Watermark for light theme */
.theme-light #main-content::before,
.theme-light .view-container::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background-image: url('../watermark.jpg');
    background-repeat: repeat;
    background-position: center;
    background-size: 350px;
    opacity: 0.02;
    z-index: -1;
    pointer-events: none;
}

/* Watermark for dark theme */
.theme-dark #main-content::before,
.theme-dark .view-container::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background-image: url('../watermark.jpg');
    background-repeat: repeat;
    background-position: center;
    background-size: 350px;
    opacity: 0.015;
    z-index: -1;
    pointer-events: none;
}

/* --- Error Toast Animations --- */
@keyframes slide-in {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

.animate-slide-in {
    animation: slide-in 0.3s ease-out;
}

#global-error-toast {
    transition: opacity 0.3s, transform 0.3s;
}

/* --- Mobile Communicator Notification Animation --- */
@keyframes phone-shake {
    0%, 100% { transform: translateX(0) rotate(0); }
    10%, 30%, 50%, 70%, 90% { transform: translateX(-2px) rotate(-5deg); }
    20%, 40%, 60%, 80% { transform: translateX(2px) rotate(5deg); }
}

@keyframes phone-pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.8; }
}

@keyframes badge-bounce {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.2); }
}

/* Animation classes for mobile communicator */
#open-mobile-communicator.has-notification {
    animation: phone-pulse 1.5s ease-in-out infinite;
}

#open-mobile-communicator.has-notification svg {
    animation: phone-shake 0.5s ease-in-out;
}

#communicator-pending-badge.has-new-message {
    animation: badge-bounce 0.5s ease-in-out 3;
}

/* --- CSP-Compliant Utility Classes --- */

/* Display utilities */
.csp-hidden {
    display: none !important;
}

.csp-block {
    display: block !important;
}

.csp-flex {
    display: flex !important;
}

/* Toast fade-out animation */
.toast-fade-out {
    opacity: 0 !important;
    transform: translateX(100%) !important;
}

/* Off-screen positioning for clipboard helper */
.csp-offscreen {
    position: absolute !important;
    left: -9999px !important;
}

/* Background image loader */
.bg-loaded {
    /* Background image will be set via data attribute and CSS custom property */
    background-image: var(--bg-image);
}

/* Gauge and bar width utilities - using CSS custom properties */
.gauge-container {
    width: var(--gauge-size, 120px);
    height: var(--gauge-size, 120px);
}

.gauge-circle {
    transition: stroke-dashoffset 0.5s;
}

/* Width setting via CSS custom property */
.bar-fg,
.burn-rate-bar,
.burn-rate-progress,
.portfolio-health-bar,
.portfolio-progress-bar,
.quality-bar,
.confidence-bar,
.data-quality-bar,
.equipment-health-bar,
#weather-impact-bar {
    width: var(--bar-width, 0%);
    transition: width 0.3s ease;
}

/* Stroke dashoffset via CSS custom property */
.gauge-fg {
    stroke-dashoffset: var(--gauge-offset, 0);
}

/* --- Enhanced Simulation Styles --- */
.anomaly-alert {
    animation: fadeIn 0.3s ease-in;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.sensor-item {
    padding: 0.5rem;
    background: rgba(15, 23, 42, 0.5);
    border-radius: 0.5rem;
    border: 1px solid rgba(71, 85, 105, 0.5);
}

.equipment-health-item {
    padding: 0.5rem;
    background: rgba(15, 23, 42, 0.5);
    border-radius: 0.5rem;
}

#weather-card {
    background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), rgba(14, 165, 233, 0.05));
    border: 1px solid rgba(6, 182, 212, 0.3);
}

#equipment-health-card {
    border-left: 3px solid rgba(234, 179, 8, 0.5);
}

#additional-sensors-card {
    border-left: 3px solid rgba(59, 130, 246, 0.5);
}

#data-quality-indicator {
    padding: 0.5rem;
    background: rgba(15, 23, 42, 0.5);
    border-radius: 0.375rem;
    border: 1px solid rgba(71, 85, 105, 0.3);
}

@media (max-width: 768px) {
    #weather-card {
        grid-column: span 2;
    }
}
