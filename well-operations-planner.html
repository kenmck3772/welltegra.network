<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self' data:; font-src 'self' data:; connect-src 'self' https://www.data.boem.gov https://gdr.openei.org https://factpages.npd.no https://raw.githubusercontent.com; media-src 'self' data:; object-src 'none'; base-uri 'self'; form-action 'self'">
    <meta name="description" content="Simulate well interventions, visualize schematics, and build daily cost forecasts with the Well-Tegra operations planner.">
    <title>Well Operations Planner | Well-Tegra</title>
    <link rel="icon" href="assets/logo.jpg" type="image/jpeg">
    <link rel="stylesheet" href="assets/css/tailwind.css">
</head>
<body class="bg-slate-950 text-slate-100 min-h-screen flex flex-col">
    <header class="border-b border-slate-800 bg-slate-900/60 backdrop-blur">
        <div class="mx-auto flex max-w-6xl flex-col gap-4 px-4 py-6 sm:flex-row sm:items-start sm:justify-between">
            <div>
                <p class="text-sm text-cyan-300">Well-Tegra Operations Suite</p>
                <h1 class="mt-1 text-2xl font-semibold">Well Operations Planner</h1>
                <p class="text-sm text-slate-400">Project: Lomond Decom &mdash; Well IE 32</p>
            </div>
            <div class="flex flex-col items-start gap-3 sm:items-end">
                <nav aria-label="Breadcrumb">
                    <ol class="flex items-center gap-2 text-sm text-slate-400">
                        <li><a class="text-cyan-300 hover:text-cyan-200" href="index.html">Home</a></li>
                        <li aria-hidden="true" class="text-slate-600">/</li>
                        <li class="text-slate-200">Operations Planner</li>
                    </ol>
                </nav>
                <button
                    id="open-mobile-communicator"
                    type="button"
                    aria-haspopup="dialog"
                    aria-controls="mobile-communicator"
                    class="inline-flex items-center gap-2 rounded-full border border-cyan-500/70 px-4 py-2 text-sm font-semibold text-cyan-200 shadow-sm transition hover:bg-cyan-500/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-400"
                >
                    <svg class="h-4 w-4 text-cyan-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 6.75a2.25 2.25 0 0 1 2.25-2.25h10.5A2.25 2.25 0 0 1 19.5 6.75v5.25a2.25 2.25 0 0 1-2.25 2.25H9.75L6 18v-3.75H6a2.25 2.25 0 0 1-2.25-2.25V6.75Z" />
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 6h6" />
                    </svg>
                    <span class="whitespace-nowrap">Mobile Communicator</span>
                    <span id="communicator-pending-badge" class="rounded-full bg-cyan-500/15 px-2 py-0.5 text-xs font-semibold text-cyan-100">0</span>
                </button>
            </div>
        </div>
    </header>

    <main class="mx-auto flex w-full max-w-6xl flex-1 flex-col gap-6 px-4 py-6">
        <section class="grid flex-1 grid-cols-1 gap-6 lg:grid-cols-3">
            <article class="flex min-h-[22rem] flex-col overflow-hidden rounded-2xl border border-slate-800 bg-slate-900 shadow-lg lg:col-span-1">
                <header class="border-b border-slate-800 bg-slate-900/80 px-5 py-4">
                    <h2 class="text-lg font-semibold">Wellbore Schematic</h2>
                </header>
                <div id="schematic-container" class="relative flex flex-1">
                    <canvas id="well-schematic" class="h-full w-full"></canvas>
                    <div id="well-tooltip" class="pointer-events-none absolute hidden rounded-lg border border-slate-700 bg-slate-900/90 px-4 py-2 text-sm shadow-lg"></div>
                </div>
            </article>

            <article class="flex min-h-[22rem] flex-col overflow-hidden rounded-2xl border border-slate-800 bg-slate-900 shadow-lg lg:col-span-1">
                <header class="border-b border-slate-800 bg-slate-900/80 px-5 py-4">
                    <h2 class="text-lg font-semibold">Operational Procedure</h2>
                </header>
                <div id="procedure-panel" class="flex-1 overflow-y-auto px-5 py-4">
                    <p class="text-sm text-slate-400">Loading procedure&hellip;</p>
                </div>
            </article>

            <article class="flex min-h-[22rem] flex-col overflow-hidden rounded-2xl border border-slate-800 bg-slate-900 shadow-lg lg:col-span-1">
                <header class="border-b border-slate-800 bg-slate-900/80 px-5 py-4">
                    <h2 class="text-lg font-semibold">Job Planner</h2>
                </header>
                <div class="flex flex-1 flex-col gap-5 overflow-y-auto px-5 py-4">
                    <section aria-labelledby="job-metrics-heading" class="rounded-xl border border-slate-800 bg-slate-950/60 p-4 shadow-inner">
                        <h3 id="job-metrics-heading" class="text-base font-semibold text-cyan-300">Job Metrics</h3>
                        <dl class="mt-3 grid grid-cols-2 gap-4 text-sm text-slate-300">
                            <div>
                                <dt class="text-slate-400">Total Length</dt>
                                <dd id="metric-length" class="mt-1 text-lg font-semibold text-sky-300">0.00 ft</dd>
                            </div>
                            <div>
                                <dt class="text-slate-400">Max OD</dt>
                                <dd id="metric-od" class="mt-1 text-lg font-semibold text-sky-300">0.00 in</dd>
                            </div>
                            <div>
                                <dt class="text-slate-400">Equipment Daily Cost</dt>
                                <dd id="metric-equip-cost" class="mt-1 text-lg font-semibold text-sky-300">$0</dd>
                            </div>
                            <div>
                                <dt class="text-slate-400">Personnel Daily Cost</dt>
                                <dd id="metric-pers-cost" class="mt-1 text-lg font-semibold text-sky-300">$0</dd>
                            </div>
                            <div class="col-span-2 border-t border-slate-800 pt-3">
                                <dt class="text-slate-400">Total Job Daily Rate</dt>
                                <dd id="metric-total-cost" class="mt-1 text-2xl font-bold text-emerald-300">$0</dd>
                            </div>
                        </dl>
                    </section>

                    <section aria-labelledby="toolstring-heading" class="flex flex-col gap-3">
                        <div class="flex items-center justify-between">
                            <h3 id="toolstring-heading" class="text-base font-semibold">Toolstring Assembly</h3>
                            <button id="clear-toolstring" type="button" class="text-xs font-semibold text-slate-400 hover:text-slate-200 focus:outline-none focus-visible:ring focus-visible:ring-cyan-500 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900">Clear</button>
                        </div>
                        <div id="toolstring-list" class="min-h-[6rem] rounded-xl border border-slate-800 bg-slate-950/40 p-3 text-sm text-slate-400">No tools added.</div>
                    </section>

                    <section aria-labelledby="personnel-heading" class="flex flex-col gap-3">
                        <div class="flex items-center justify-between">
                            <h3 id="personnel-heading" class="text-base font-semibold">Personnel on Job</h3>
                            <button id="clear-personnel" type="button" class="text-xs font-semibold text-slate-400 hover:text-slate-200 focus:outline-none focus-visible:ring focus-visible:ring-cyan-500 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900">Clear</button>
                        </div>
                        <div id="personnel-list" class="min-h-[5rem] rounded-xl border border-slate-800 bg-slate-950/40 p-3 text-sm text-slate-400">No personnel added.</div>
                    </section>

                    <section aria-labelledby="quick-add-heading" class="mt-auto rounded-xl border border-slate-800 bg-slate-950/60 p-4">
                        <h3 id="quick-add-heading" class="text-sm font-semibold uppercase tracking-wide text-slate-300">Quick Add</h3>
                        <div class="mt-3 flex flex-wrap gap-2">
                            <button type="button" class="rounded-full bg-sky-600 px-3 py-1 text-xs font-semibold text-white shadow hover:bg-sky-500 focus:outline-none focus-visible:ring focus-visible:ring-sky-300" data-add-tool="TS-001">Rope Socket</button>
                            <button type="button" class="rounded-full bg-sky-600 px-3 py-1 text-xs font-semibold text-white shadow hover:bg-sky-500 focus:outline-none focus-visible:ring focus-visible:ring-sky-300" data-add-tool="TS-003">Stem</button>
                            <button type="button" class="rounded-full bg-sky-600 px-3 py-1 text-xs font-semibold text-white shadow hover:bg-sky-500 focus:outline-none focus-visible:ring focus-visible:ring-sky-300" data-add-tool="TS-007">Spang Jar</button>
                            <button type="button" class="rounded-full bg-sky-600 px-3 py-1 text-xs font-semibold text-white shadow hover:bg-sky-500 focus:outline-none focus-visible:ring focus-visible:ring-sky-300" data-add-tool="FSH-001">2 Prong Grab</button>
                            <button type="button" class="rounded-full bg-emerald-600 px-3 py-1 text-xs font-semibold text-white shadow hover:bg-emerald-500 focus:outline-none focus-visible:ring focus-visible:ring-emerald-300" data-add-personnel="PERS-001">Wellsite Engineer</button>
                            <button type="button" class="rounded-full bg-emerald-600 px-3 py-1 text-xs font-semibold text-white shadow hover:bg-emerald-500 focus:outline-none focus-visible:ring focus-visible:ring-emerald-300" data-add-personnel="PERS-004">Wireline Engineer</button>
                        </div>
                    </section>

                    <button id="save-plan" type="button" class="w-full rounded-xl bg-cyan-500 px-4 py-3 text-sm font-semibold text-slate-900 shadow hover:bg-cyan-400 focus:outline-none focus-visible:ring focus-visible:ring-slate-100">Save Plan</button>
                </div>
            </article>
        </section>
    </main>

    <div
        id="mobile-communicator"
        class="pointer-events-none fixed inset-0 z-40 hidden place-items-center bg-slate-950/80 px-4 py-8"
        role="dialog"
        aria-modal="true"
        aria-labelledby="mobile-communicator-title"
    >
        <section class="pointer-events-auto flex w-full max-w-5xl flex-col overflow-hidden rounded-3xl border border-slate-800 bg-slate-900 shadow-2xl">
            <header class="flex items-start justify-between gap-3 border-b border-slate-800 bg-slate-900/80 px-6 py-5">
                <div>
                    <p class="text-xs font-semibold uppercase tracking-[0.35em] text-cyan-300">Remote sign-off</p>
                    <h2 id="mobile-communicator-title" class="mt-2 text-2xl font-semibold text-slate-100">Mobile Communicator</h2>
                    <p class="text-sm text-slate-400">Approve Management of Change requests and programme amendments without leaving the deck.</p>
                </div>
                <button
                    id="close-mobile-communicator"
                    type="button"
                    class="rounded-full border border-slate-700/60 p-2 text-slate-300 transition hover:bg-slate-800 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-400"
                    aria-label="Close mobile communicator panel"
                >
                    <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 6l12 12M6 18L18 6" />
                    </svg>
                </button>
            </header>
            <div class="grid gap-6 px-6 py-6 lg:grid-cols-[17rem_1fr]">
                <section class="flex flex-col gap-5">
                    <div class="grid gap-3 text-sm text-slate-200 sm:grid-cols-3">
                        <div class="rounded-2xl border border-slate-800 bg-slate-950/70 p-4 shadow-inner">
                            <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Total</p>
                            <p id="communicator-summary-total" class="mt-2 text-2xl font-semibold text-slate-100">0</p>
                        </div>
                        <div class="rounded-2xl border border-slate-800 bg-slate-950/70 p-4 shadow-inner">
                            <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Pending</p>
                            <p id="communicator-summary-pending" class="mt-2 text-2xl font-semibold text-amber-300">0</p>
                        </div>
                        <div class="rounded-2xl border border-slate-800 bg-slate-950/70 p-4 shadow-inner">
                            <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Approved</p>
                            <p id="communicator-summary-approved" class="mt-2 text-2xl font-semibold text-emerald-300">0</p>
                        </div>
                    </div>
                    <p class="text-xs text-slate-500">Last synced <span id="communicator-last-sync">—</span></p>
                    <div class="flex-1 overflow-hidden rounded-2xl border border-slate-800 bg-slate-950/60">
                        <h3 class="border-b border-slate-800 px-4 py-3 text-sm font-semibold text-slate-200">Requests</h3>
                        <div class="max-h-80 overflow-y-auto px-2 py-3">
                            <p id="communicator-empty" class="hidden px-3 py-6 text-sm text-slate-400">No change requests are active.</p>
                            <ul id="communicator-request-list" class="flex flex-col gap-2" aria-label="Mobile communicator requests"></ul>
                        </div>
                    </div>
                </section>
                <section class="flex min-h-[24rem] flex-col gap-5 rounded-2xl border border-slate-800 bg-slate-950/60 p-5">
                    <div class="flex flex-col gap-3">
                        <div class="flex flex-wrap items-center gap-3">
                            <span id="communicator-detail-status" class="hidden rounded-full border border-slate-700/70 bg-slate-800/80 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-slate-200"></span>
                            <span id="communicator-detail-category" class="hidden rounded-full bg-cyan-500/15 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-cyan-200"></span>
                            <p id="communicator-detail-meta" class="text-xs text-slate-500"></p>
                        </div>
                        <h3 id="communicator-detail-title" class="text-xl font-semibold text-slate-100">Select a change request</h3>
                        <p id="communicator-detail-summary" class="text-sm leading-relaxed text-slate-300">Choose a request from the list to review the justification, impact, and supporting evidence before granting remote approval.</p>
                        <dl id="communicator-detail-impact" class="grid gap-3 text-sm text-slate-300 sm:grid-cols-3"></dl>
                    </div>
                    <div>
                        <h4 class="text-xs font-semibold uppercase tracking-wide text-slate-400">Watchers</h4>
                        <ul id="communicator-detail-watchers" class="mt-2 flex flex-wrap gap-2 text-xs text-slate-300"></ul>
                    </div>
                    <div class="flex-1 overflow-hidden rounded-xl border border-slate-800 bg-slate-900/40">
                        <h4 class="border-b border-slate-800 px-4 py-3 text-sm font-semibold text-slate-200">Decision trail</h4>
                        <ol id="communicator-timeline" class="max-h-48 space-y-3 overflow-y-auto px-4 py-3 text-sm text-slate-300"></ol>
                    </div>
                    <form id="communicator-signoff-form" class="space-y-3 rounded-xl border border-slate-800 bg-slate-900/50 p-4" aria-describedby="communicator-feedback">
                        <div class="grid gap-3 sm:grid-cols-2">
                            <label class="flex flex-col gap-1 text-xs font-semibold uppercase tracking-wide text-slate-400">
                                Approver email
                                <input id="communicator-email" type="email" class="rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-100 focus:border-cyan-400 focus:outline-none focus:ring-2 focus:ring-cyan-500/50" placeholder="name@welltegra.com" autocomplete="email">
                            </label>
                            <label class="flex flex-col gap-1 text-xs font-semibold uppercase tracking-wide text-slate-400">
                                Secure PIN
                                <input id="communicator-pin" type="password" inputmode="numeric" pattern="[0-9]*" maxlength="6" class="rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-100 focus:border-cyan-400 focus:outline-none focus:ring-2 focus:ring-cyan-500/50" placeholder="••••" autocomplete="one-time-code">
                            </label>
                        </div>
                        <label class="flex flex-col gap-1 text-xs font-semibold uppercase tracking-wide text-slate-400">
                            Comment (optional)
                            <textarea id="communicator-comment" rows="3" class="w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-100 focus:border-cyan-400 focus:outline-none focus:ring-2 focus:ring-cyan-500/50" placeholder="Note for the log"></textarea>
                        </label>
                        <div class="flex flex-wrap items-center justify-between gap-3">
                            <p id="communicator-feedback" class="text-sm text-slate-400" role="status" aria-live="polite"></p>
                            <div class="flex flex-wrap gap-2">
                                <button type="button" data-decision="reject" class="rounded-full border border-rose-500/60 px-4 py-2 text-sm font-semibold text-rose-200 transition hover:bg-rose-500/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-rose-500">Reject</button>
                                <button type="button" data-decision="approve" class="rounded-full border border-emerald-500/60 bg-emerald-500/10 px-4 py-2 text-sm font-semibold text-emerald-200 transition hover:bg-emerald-500/20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-400">Approve</button>
                            </div>
                        </div>
                    </form>
                </section>
            </div>
            <section class="border-t border-slate-800 bg-slate-900/70 px-6 py-5">
                <h3 class="text-sm font-semibold text-slate-200">Activity feed</h3>
                <p class="mt-1 text-xs text-slate-500">Trace every remote decision and plan update captured through the communicator channel.</p>
                <ol id="communicator-feed" class="mt-4 space-y-3 text-sm text-slate-300"></ol>
                <p id="communicator-feed-empty" class="mt-4 hidden text-sm text-slate-400">No activity recorded yet. Save a plan or approve a request to build the audit trail.</p>
            </section>
        </section>
    </div>

    <div id="toast" role="status" aria-live="polite" class="pointer-events-none fixed bottom-6 right-6 hidden rounded-full bg-emerald-500 px-5 py-3 text-sm font-semibold text-slate-900 shadow-lg">Job plan saved</div>

    <script src="assets/js/well-operations-planner.js" defer></script>
    <script src="assets/js/mobile-communicator.js" defer></script>
</body>
</html>
